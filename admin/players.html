<script>
    // Load Players
    function loadPlayers() {
        db.ref("players").on("value", (snapshot) => {
            const tbody = document.getElementById("player-list");
            tbody.innerHTML = "";

            snapshot.forEach(child => {
                const player = child.val();
                tbody.innerHTML += `
                    <tr>
                        <td>${child.key}</td>
                        <td>${player.name || 'Anonymous'}</td>
                        <td>${player.email || 'N/A'}</td>
                        <td>${player.totalClicks || 0}</td>
                        <td>${player.rank || 'N/A'}</td>
                        <td>${(player.walletBalance || 0).toFixed(3)} ETH</td>
                        <td>${player.registrationDate || 'Unknown'}</td>
                        <td>${player.banned ? '❌ Banned' : '✅ Active'}</td>
                        <td>
                            <button class="edit btn" onclick="editPlayer('${child.key}')">Edit</button>
                            <button class="ban btn" onclick="toggleBan('${child.key}', ${player.banned})">
                                ${player.banned ? 'Unban' : 'Ban'}
                            </button>
                        </td>
                    </tr>
                `;
            });
        });
    }

    // Toggle Ban Status
    function toggleBan(playerId, isBanned) {
        const newStatus = !isBanned;
        db.ref(`players/${playerId}`).update({ banned: newStatus })
            .then(() => alert(`Player ${newStatus ? 'banned' : 'unbanned'} successfully!`))
            .catch(error => alert("Error: " + error.message));
    }

    // Initial Load
    loadPlayers();
</script>
